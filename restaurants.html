<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Restaurants disponibles</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    .filters {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-bottom: 20px;
    }
    select {
      padding: 6px 12px;
      font-size: 16px;
    }
  </style>
</head>
<body>
  <h1>Restaurants disponibles</h1>

  <div class="filters">
    <select id="region-filter">
      <option value="">Toutes les régions</option>
    </select>

    <select id="ville-filter" disabled>
      <option value="">Toutes les villes</option>
    </select>

    <select id="quartier-filter" disabled>
      <option value="">Tous les quartiers</option>
    </select>
  </div>

  <div id="services-container" class="services-container"></div>

  <script>
    let services = [];
    const regionFilter = document.getElementById('region-filter');
    const villeFilter = document.getElementById('ville-filter');
    const quartierFilter = document.getElementById('quartier-filter');
    const container = document.getElementById('services-container');

    fetch('services.json')
      .then(response => response.json())
      .then(data => {
        services = data.filter(item => item.categorie === 'restaurant');

        const regions = [...new Set(services.map(s => s.region))].sort();
        regions.forEach(region => {
          const option = document.createElement('option');
          option.value = region;
          option.textContent = region;
          regionFilter.appendChild(option);
        });

        displayServices(services);
      });

    function displayServices(list) {
      container.innerHTML = '';
      if (list.length === 0) {
        container.innerHTML = '<p>Aucun restaurant trouvé.</p>';
        return;
      }
      list.forEach(service => {
        const card = document.createElement('div');
        card.classList.add('service-card');
        card.innerHTML = `
          <img src="${service.image}" alt="${service.nom}" />
          <h3>${service.nom}</h3>
          <p><strong>Région :</strong> ${service.region}</p>
          <p><strong>Ville :</strong> ${service.ville}</p>
          <p><strong>Quartier :</strong> ${service.quartier}</p>
          <p><strong>Adresse :</strong> ${service.adresse}</p>
        `;
        container.appendChild(card);
      });
    }

    regionFilter.addEventListener('change', () => {
      const selectedRegion = regionFilter.value;
      if (selectedRegion) {
        villeFilter.disabled = false;
        const villes = [...new Set(services.filter(s => s.region === selectedRegion).map(s => s.ville))].sort();
        villeFilter.innerHTML = '<option value="">Toutes les villes</option>';
        villes.forEach(ville => {
          const option = document.createElement('option');
          option.value = ville;
          option.textContent = ville;
          villeFilter.appendChild(option);
        });
      } else {
        villeFilter.disabled = true;
        villeFilter.innerHTML = '<option value="">Toutes les villes</option>';
      }
      quartierFilter.disabled = true;
      quartierFilter.innerHTML = '<option value="">Tous les quartiers</option>';
      filterAndDisplay();
    });

    villeFilter.addEventListener('change', () => {
      const selectedRegion = regionFilter.value;
      const selectedVille = villeFilter.value;
      if (selectedVille) {
        quartierFilter.disabled = false;
        const quartiers = [...new Set(services.filter(s => s.region === selectedRegion && s.ville === selectedVille).map(s => s.quartier))].sort();
        quartierFilter.innerHTML = '<option value="">Tous les quartiers</option>';
        quartiers.forEach(quartier => {
          const option = document.createElement('option');
          option.value = quartier;
          option.textContent = quartier;
          quartierFilter.appendChild(option);
        });
      } else {
        quartierFilter.disabled = true;
        quartierFilter.innerHTML = '<option value="">Tous les quartiers</option>';
      }
      filterAndDisplay();
    });

    quartierFilter.addEventListener('change', () => {
      filterAndDisplay();
    });

    function filterAndDisplay() {
      const selectedRegion = regionFilter.value;
      const selectedVille = villeFilter.value;
      const selectedQuartier = quartierFilter.value;

      let filtered = services;
      if (selectedRegion) filtered = filtered.filter(s => s.region === selectedRegion);
      if (selectedVille) filtered = filtered.filter(s => s.ville === selectedVille);
      if (selectedQuartier) filtered = filtered.filter(s => s.quartier === selectedQuartier);

      displayServices(filtered);
    }
  </script>
</body>
</html>
