<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ajouter un service</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      background-color: #f2f2f2;
    }
    form {
      background: white;
      padding: 20px;
      border-radius: 8px;
      max-width: 500px;
      margin: auto;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    input, select, textarea, button {
      width: 100%;
      margin-bottom: 15px;
      padding: 10px;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 1em;
    }
    button {
      background-color: #28a745;
      color: white;
      font-weight: bold;
      cursor: pointer;
    }
    button:hover {
      background-color: #218838;
    }
  </style>
</head>
<body>

  <h2 style="text-align: center;">Ajouter un service</h2>

  <form id="ajouterForm">
    <label>Cat√©gorie</label>
    <select name="categorie" required>
      <option value="hotel">H√¥tel</option>
      <option value="restaurant">Restaurant</option>
      <option value="pharmacie">Pharmacie</option>
    </select>

    <label>Nom</label>
    <input type="text" name="nom" required />

    <label>R√©gion</label>
    <select name="region" id="regionSelect" required>
      <option value="">S√©lectionnez une r√©gion</option>
      <option value="Nord">Nord</option>
      <option value="Sud">Sud</option>
      <option value="Est">Est</option>
      <option value="Ouest">Ouest</option>
      <option value="Centre">Centre</option>
    </select>

    <label>Ville</label>
    <select name="ville" id="villeSelect" required></select>

    <label>Quartier</label>
    <input type="text" name="quartier" required />

    <label>Adresse</label>
    <input type="text" name="adresse" required />

    <label>Description</label>
    <textarea name="description" required></textarea>

    <button type="submit">Ajouter le service</button>
  </form>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <script>
    // üîê Cl√©s Supabase
    const supabaseUrl = "https://zsnovjyzgdyhvuctwozz.supabase.co";
    const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inpzbm92anl6Z2R5aHZ1Y3R3b3p6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE2NTczMTQsImV4cCI6MjA2NzIzMzMxNH0.r2QCyhhdZS5Ksmjh3is5bK8PAOH8LWEFMlzJV0IwaU4";

    const supabase = supabase.createClient(supabaseUrl, supabaseKey);

    // G√©rer les villes dynamiquement selon la r√©gion
    const villesParRegion = {
      "Nord": ["Korhogo", "Ferk√©", "Boundiali"],
      "Sud": ["Abidjan", "Grand-Bassam", "Dabou"],
      "Est": ["Bondoukou", "Agnibil√©krou"],
      "Ouest": ["Man", "Du√©kou√©", "Guiglo"],
      "Centre": ["Yamoussoukro", "Bongouanou", "Bouak√©"]
    };

    document.getElementById("regionSelect").addEventListener("change", function () {
      const region = this.value;
      const villes = villesParRegion[region] || [];
      const villeSelect = document.getElementById("villeSelect");

      villeSelect.innerHTML = '<option value="">S√©lectionnez une ville</option>';
      villes.forEach(ville => {
        const opt = document.createElement("option");
        opt.value = ville;
        opt.textContent = ville;
        villeSelect.appendChild(opt);
      });
    });

    // Ajouter le service √† Supabase
    document.getElementById("ajouterForm").addEventListener("submit", async function (e) {
      e.preventDefault();

      const formData = new FormData(this);
      const data = {};
      formData.forEach((value, key) => { data[key] = value });

      const { error } = await supabase.from("services").insert([data]);

      if (error) {
        alert("Erreur : " + error.message);
        console.error(error);
      } else {
        alert("Service ajout√© avec succ√®s !");
        this.reset();
      }
    });
  </script>
</body>
</html>
